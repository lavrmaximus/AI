Этот Python файл представляет собой класс `Database`, который отвечает за взаимодействие с базой данных PostgreSQL. Основные функции класса включают:

1. **Инициализация базы данных**: Подключение к PostgreSQL через DSN, построенный из переменных окружения, и создание необходимых таблиц.
2. **Манипуляции с бизнесами**: Методы для создания бизнеса, получения списка бизнесов пользователя и добавления "снимков" состояния бизнесов с метриками.
3. **Управление сессиями разговоров**: Создание, обновление и получение данных сессий для осуществления умного диалога.
4. **Логирование сообщений**: Сохранение сообщений пользователей и ответов бота.
5. **Получение статистики**: Методы для получения системной статистики, такой как общее количество пользователей и активных пользователей за последние 24 часа.
6. **Советы**: Получение последних советов на основе историй бизнесов.

Используются библиотеки `asyncio`, `psycopg2` и `dotenv` для асинхронной работы и конфигурации. Код учитывает локальные и продакшен режимы и включает обработку ошибок подключения к базе данных.